**Project Enhancement: Accurate Entity Counting and Total Allocated Budget Calculation**

**Objective:**
Refine the PHP data fetching and processing logic to accurately count created entities and calculate the true **Total Allocated Budget** for entities created within the selected time period, addressing the structural dependency between Campaigns, Ad Sets, and Ads.

**CRITICAL LOGIC ADJUSTMENTS:**

1.  **Accurate Entity Counting (Focus on Incremental Creation):**
    * The goal is to count **distinct creative work** or new strategic units.
    * **Replit Task:** Implement logic that prioritizes counting the creation of the lower-level entities (`Ad Sets` and `Ads`). The sum of `Ad Sets Created` and `Ads Created` is often a better proxy for "work done" than including `Campaigns Created` directly, as Campaigns usually precede Ad Sets/Ads.
    * **Focus on fetching and counting:** **Ad Sets** and **Ads** created within the specified time frame. (We will exclude the Campaign count from the final 'Total Entities' sum to avoid triple-counting.)

2.  **Advanced Allocated Budget Calculation:**
    * The PHP logic must accurately determine the total allocated budget for **all newly created Ad Sets and/or Ads**.
    * **Required Fields to Fetch (API):**
        * `effective_status` (to ensure the entity is relevant)
        * `budget_remaining` (for context)
        * **`daily_budget`**
        * **`lifetime_budget`**
        * **`start_time`**
        * **`end_time`** (CRITICAL for duration calculation)

    * **Budget Calculation Formula (PHP Implementation):**
        * **IF `lifetime_budget` is set:** Use this value directly as the Allocated Budget for that entity.
        * **IF `daily_budget` is set:** The PHP script must calculate the budget duration.
            * **Duration Calculation:** Determine the number of days between `start_time` and `end_time` (inclusive).
            * **Total Allocated Budget = `daily_budget` $\times$ Duration (in days)**
        * **Aggregation:** Sum all calculated Total Allocated Budgets for all created entities within the Ad Account/Timeframe.

3.  **Data Integrity Check:**
    * Ensure the data displayed (Creation Count and Budget) corresponds to the entity's **`created_time`** matching the filter, but the budget calculation uses the entity's **`start_time`** and **`end_time`**.

**Replit Agent Tasks:**

1.  **API Call Update:** Modify API calls to ensure they retrieve the necessary date/budget fields: `daily_budget`, `lifetime_budget`, `start_time`, and `end_time` for both Ad Set and Ad level data.
2.  **PHP Calculation Function:** Write a dedicated PHP function (e.g., `calculateTotalAllocatedBudget($entity_data)`) that implements the duration-based calculation logic described above. This function must handle cases where `end_time` might be null or missing (e.g., set a safe default).
3.  **Report Count Adjustment:** Modify the reporting logic to focus the 'Total Entities' count on **Ad Sets Created + Ads Created**, removing the simple Campaign count from the sum.
4.  **Updated Report Table:** Display the recalculated, accurate **Total Allocated Budget** in the final report table.

**Start by providing the updated PHP code structure for fetching data from the Ad Set/Ad endpoints and the prototype for the `calculateTotalAllocatedBudget` function.**